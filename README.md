# Glasses Classification

## Train

You can find train script and logs in [notebooks/glasses-modeling](https://github.com/yisaienkov/glasses_classification/blob/master/notebooks/glasses-modeling.ipynb).   

Constraints:
- As you can see from the notebook's logs inference time is less than 10ms on Tesla P100.
- The model weighs ~400 kb

I use a dataset generated by GAN. [Dataset link](https://www.kaggle.com/jeffheaton/glasses-or-no-glasses). It contains so clear faces on all frames. I try to use augmentations to create a dataset more realistic and similar to production faces. And dataset has a lot of incorrect labels (You can find some cases in the notebook).

**Important note:** On the inference, I cut out a square section from the middle of the photo, since in most cases the glasses will be in this area. Thus, the photos become more like a training dataset.

## Deploy

### Main script

You can simply build and run the docker container to see the result.

```bash
> docker build -t glasses_classification_pipeline -f app_main.Dockerfile .

> docker run -v <full_path>/with_glasses/:/app/images/ glasses_classification_pipeline

Found glasses (0.979): images/0.jpg
Found glasses (0.909): images/1.jpg
Found glasses (0.793): images/2.jpg
Found glasses (0.627): images/3.jpg
Found glasses (0.993): images/4.jpg
Found glasses (0.945): images/5.jpg
Found glasses (0.981): images/6.jpg
Found glasses (0.934): images/7.jpg
Found glasses (0.963): images/8.jpg
Found glasses (0.731): images/9.jpg
Found glasses (0.858): images/10.jpg
Found glasses (0.562): images/11.jpg
Found glasses (0.813): images/12.jpg
Found glasses (0.787): images/13.jpg
Found glasses (0.991): images/14.jpg
Found glasses (0.889): images/15.jpg
Found glasses (0.943): images/16.jpg
Found glasses (0.961): images/17.jpg
Found glasses (0.848): images/18.jpg
Found glasses (0.857): images/19.jpg

> docker run -v <full_path>/without_glasses/:/app/images/ glasses_classification_pipeline

Found glasses (0.742): images/2.jpg
Found glasses (0.957): images/6.jpg
Found glasses (0.595): images/9.jpg
Found glasses (0.818): images/13.jpg
Found glasses (0.944): images/14.jpg
Found glasses (0.850): images/15.jpg
Found glasses (0.574): images/16.jpg
Found glasses (0.919): images/17.jpg
```


### Web interface

```bash
> docker build -t glasses_classification_web -f app_web.Dockerfile .

> docker run -p 5000:5000 glasses_classification_web
```

Go to [localhost:5000](http://localhost:5000) and load some images:

![Imgur](https://i.imgur.com/LUQcEvd.png)
